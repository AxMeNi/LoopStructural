<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>3a. Modelling faults using structural frames &mdash; LoopStructural 0.1 documentation</title><link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-rendered-html.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Contribute" href="../../contributors_guide.html" />
    <link rel="prev" title="2b. Refolded folds" href="../2_fold/plot_refolded_folds.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> LoopStructural
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Loop Structural</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting Started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../background.html">Background</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#basics">1. Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#modelling-folds">2. Modelling Folds</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#modelling-faults">3. Modelling Faults</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">3a. Modelling faults using structural frames</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#modelling-faults-using-structural-frames">Modelling faults using structural frames</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../contributors_guide.html">Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/input_data.html">Input data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/geological_model.html">Geological Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/interpolation_options.html">Implicit Interpolators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/fold_modelling.html">Fold modelling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/fault_modelling.html">Fault modelling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/visualisation.html">Visualisation</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../_autosummary/LoopStructural.html">LoopStructural</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">LoopStructural</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Examples</a> &raquo;</li>
      <li>3a. Modelling faults using structural frames</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/auto_examples/3_fault/plot_faulted_intrusion.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-3-fault-plot-faulted-intrusion-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="a-modelling-faults-using-structural-frames">
<span id="sphx-glr-auto-examples-3-fault-plot-faulted-intrusion-py"></span><h1>3a. Modelling faults using structural frames<a class="headerlink" href="#a-modelling-faults-using-structural-frames" title="Permalink to this headline">¶</a></h1>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">LoopStructural</span> <span class="kn">import</span> <a href="../../_autosummary/LoopStructural.modelling.core.geological_model.GeologicalModel.html#LoopStructural.modelling.core.geological_model.GeologicalModel" title="LoopStructural.modelling.core.geological_model.GeologicalModel" class="sphx-glr-backref-module-LoopStructural-modelling-core-geological_model sphx-glr-backref-type-py-class"><span class="n">GeologicalModel</span></a>
<span class="kn">from</span> <span class="nn">LoopStructural.visualisation</span> <span class="kn">import</span> <a href="../../_autosummary/LoopStructural.visualisation.LavaVuModelViewer.html#LoopStructural.visualisation.LavaVuModelViewer" title="LoopStructural.visualisation.LavaVuModelViewer" class="sphx-glr-backref-module-LoopStructural-visualisation sphx-glr-backref-type-py-class"><span class="n">LavaVuModelViewer</span></a>
<span class="kn">from</span> <span class="nn">LoopStructural.datasets</span> <span class="kn">import</span> <a href="../../_autosummary/LoopStructural.datasets.load_intrusion.html#LoopStructural.datasets.load_intrusion" title="LoopStructural.datasets.load_intrusion" class="sphx-glr-backref-module-LoopStructural-datasets sphx-glr-backref-type-py-function"><span class="n">load_intrusion</span></a>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">data</span><span class="p">,</span> <span class="n">bb</span> <span class="o">=</span> <a href="../../_autosummary/LoopStructural.datasets.load_intrusion.html#LoopStructural.datasets.load_intrusion" title="LoopStructural.datasets.load_intrusion" class="sphx-glr-backref-module-LoopStructural-datasets sphx-glr-backref-type-py-function"><span class="n">load_intrusion</span></a><span class="p">()</span>
</pre></div>
</div>
<div class="section" id="modelling-faults-using-structural-frames">
<h2>Modelling faults using structural frames<a class="headerlink" href="#modelling-faults-using-structural-frames" title="Permalink to this headline">¶</a></h2>
<p>Standard implicit modelling techniques either treat faults as domain
boundaries or use a step function in the implicit function to capture
the displacement in the faulted surface.</p>
<p>Adding faults into the implicit function using step functions is limited
because this does not capture the kinematics of the fault. It
effectively defines the fault displacement by adding a value to the
scalar field on the hanging wall of the fault. In the example below a
2-D ellipsoidal function is combined with a step function to show how
the resulting geometry results in a shrinking shape. This would be
representative of modelling an intrusion.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">intrusion</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<a href="../../_autosummary/LoopStructural.modelling.fault.FaultSegment.html#LoopStructural.modelling.fault.FaultSegment" title="LoopStructural.modelling.fault.FaultSegment" class="sphx-glr-backref-module-LoopStructural-modelling-fault sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fault</span></a> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">xx</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<a href="../../_autosummary/LoopStructural.modelling.fault.FaultSegment.html#LoopStructural.modelling.fault.FaultSegment" title="LoopStructural.modelling.fault.FaultSegment" class="sphx-glr-backref-module-LoopStructural-modelling-fault sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fault</span></a><span class="p">[</span><span class="n">yy</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">val</span> <span class="o">=</span> <span class="n">intrusion</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">)</span><span class="o">+</span><a href="../../_autosummary/LoopStructural.modelling.fault.FaultSegment.html#LoopStructural.modelling.fault.FaultSegment" title="LoopStructural.modelling.fault.FaultSegment" class="sphx-glr-backref-module-LoopStructural-modelling-fault sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fault</span></a>


<span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_faulted_intrusion_001.png" srcset="../../_images/sphx_glr_plot_faulted_intrusion_001.png" alt="plot faulted intrusion" class = "sphx-glr-single-img"/><p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.contour.QuadContourSet object at 0x7f336ab54760&gt;
</pre></div>
</div>
<p>LoopStructural applies structural frames to the fault geometry to
capture the geometry and kinematics of the fault. A fault frame
consisting of the fault surface, fault slip direction and fault extent
are built from observations. The geometry of the deformed surface is
then interpolated by first restoring the observations by combining the
fault frame and an expected displacement model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../_autosummary/LoopStructural.modelling.core.geological_model.GeologicalModel.html#LoopStructural.modelling.core.geological_model.GeologicalModel" title="LoopStructural.modelling.core.geological_model.GeologicalModel" class="sphx-glr-backref-module-LoopStructural-modelling-core-geological_model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model</span></a> <span class="o">=</span> <a href="../../_autosummary/LoopStructural.modelling.core.geological_model.GeologicalModel.html#LoopStructural.modelling.core.geological_model.GeologicalModel" title="LoopStructural.modelling.core.geological_model.GeologicalModel" class="sphx-glr-backref-module-LoopStructural-modelling-core-geological_model sphx-glr-backref-type-py-class"><span class="n">GeologicalModel</span></a><span class="p">(</span><span class="n">bb</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="n">bb</span><span class="p">[</span><span class="mi">1</span><span class="p">,:])</span>
<a href="../../_autosummary/LoopStructural.modelling.core.geological_model.GeologicalModel.html#LoopStructural.modelling.core.geological_model.GeologicalModel" title="LoopStructural.modelling.core.geological_model.GeologicalModel" class="sphx-glr-backref-module-LoopStructural-modelling-core-geological_model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model</span></a><span class="o">.</span><span class="n">set_model_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a href="../../_autosummary/LoopStructural.modelling.fault.FaultSegment.html#LoopStructural.modelling.fault.FaultSegment" title="LoopStructural.modelling.fault.FaultSegment" class="sphx-glr-backref-module-LoopStructural-modelling-fault sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fault</span></a> <span class="o">=</span> <a href="../../_autosummary/LoopStructural.modelling.core.geological_model.GeologicalModel.html#LoopStructural.modelling.core.geological_model.GeologicalModel.create_and_add_fault" title="LoopStructural.modelling.core.geological_model.GeologicalModel.create_and_add_fault" class="sphx-glr-backref-module-LoopStructural-modelling-core-geological_model sphx-glr-backref-type-py-method"><span class="n">model</span><span class="o">.</span><span class="n">create_and_add_fault</span></a><span class="p">(</span><span class="s1">&#39;fault&#39;</span><span class="p">,</span>
                                   <span class="mi">500</span><span class="p">,</span>
                                   <span class="n">nelements</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
                                   <span class="n">steps</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                                   <span class="n">interpolatortype</span><span class="o">=</span><span class="s1">&#39;PLI&#39;</span><span class="p">,</span>
                                  <span class="n">buffer</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<a href="../../_autosummary/LoopStructural.visualisation.LavaVuModelViewer.html#LoopStructural.visualisation.LavaVuModelViewer" title="LoopStructural.visualisation.LavaVuModelViewer" class="sphx-glr-backref-module-LoopStructural-visualisation sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">viewer</span></a> <span class="o">=</span> <a href="../../_autosummary/LoopStructural.visualisation.LavaVuModelViewer.html#LoopStructural.visualisation.LavaVuModelViewer" title="LoopStructural.visualisation.LavaVuModelViewer" class="sphx-glr-backref-module-LoopStructural-visualisation sphx-glr-backref-type-py-class"><span class="n">LavaVuModelViewer</span></a><span class="p">(</span><a href="../../_autosummary/LoopStructural.modelling.core.geological_model.GeologicalModel.html#LoopStructural.modelling.core.geological_model.GeologicalModel" title="LoopStructural.modelling.core.geological_model.GeologicalModel" class="sphx-glr-backref-module-LoopStructural-modelling-core-geological_model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model</span></a><span class="p">)</span>
<a href="../../_autosummary/LoopStructural.visualisation.LavaVuModelViewer.html#LoopStructural.visualisation.LavaVuModelViewer.add_isosurface" title="LoopStructural.visualisation.LavaVuModelViewer.add_isosurface" class="sphx-glr-backref-module-LoopStructural-visualisation sphx-glr-backref-type-py-method"><span class="n">viewer</span><span class="o">.</span><span class="n">add_isosurface</span></a><span class="p">(</span><a href="../../_autosummary/LoopStructural.modelling.fault.FaultSegment.html#LoopStructural.modelling.fault.FaultSegment" title="LoopStructural.modelling.fault.FaultSegment" class="sphx-glr-backref-module-LoopStructural-modelling-fault sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fault</span></a><span class="p">,</span>

                      <span class="n">isovalue</span><span class="o">=</span><span class="mi">0</span>
<span class="c1">#                       slices=[0,1]#nslices=10</span>
                     <span class="p">)</span>
<span class="n">xyz</span> <span class="o">=</span> <a href="../../_autosummary/LoopStructural.modelling.core.geological_model.GeologicalModel.html#LoopStructural.modelling.core.geological_model.GeologicalModel.data" title="LoopStructural.modelling.core.geological_model.GeologicalModel.data" class="sphx-glr-backref-module-LoopStructural-modelling-core-geological_model sphx-glr-backref-type-py-attribute"><span class="n">model</span><span class="o">.</span><span class="n">data</span></a><span class="p">[</span><a href="../../_autosummary/LoopStructural.modelling.core.geological_model.GeologicalModel.html#LoopStructural.modelling.core.geological_model.GeologicalModel.data" title="LoopStructural.modelling.core.geological_model.GeologicalModel.data" class="sphx-glr-backref-module-LoopStructural-modelling-core-geological_model sphx-glr-backref-type-py-attribute"><span class="n">model</span><span class="o">.</span><span class="n">data</span></a><span class="p">[</span><span class="s1">&#39;feature_name&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;strati&#39;</span><span class="p">][[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">xyz</span> <span class="o">=</span> <span class="n">xyz</span><span class="p">[</span><a href="../../_autosummary/LoopStructural.modelling.fault.FaultSegment.html#LoopStructural.modelling.fault.FaultSegment.evaluate" title="LoopStructural.modelling.fault.FaultSegment.evaluate" class="sphx-glr-backref-module-LoopStructural-modelling-fault sphx-glr-backref-type-py-method"><span class="n">fault</span><span class="o">.</span><span class="n">evaluate</span></a><span class="p">(</span><span class="n">xyz</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),:]</span>
<a href="../../_autosummary/LoopStructural.visualisation.LavaVuModelViewer.html#LoopStructural.visualisation.LavaVuModelViewer.add_vector_field" title="LoopStructural.visualisation.LavaVuModelViewer.add_vector_field" class="sphx-glr-backref-module-LoopStructural-visualisation sphx-glr-backref-type-py-method"><span class="n">viewer</span><span class="o">.</span><span class="n">add_vector_field</span></a><span class="p">(</span><a href="../../_autosummary/LoopStructural.modelling.fault.FaultSegment.html#LoopStructural.modelling.fault.FaultSegment" title="LoopStructural.modelling.fault.FaultSegment" class="sphx-glr-backref-module-LoopStructural-modelling-fault sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fault</span></a><span class="p">,</span> <span class="n">locations</span><span class="o">=</span> <span class="n">xyz</span><span class="p">)</span>
<a href="../../_autosummary/LoopStructural.visualisation.LavaVuModelViewer.html#LoopStructural.visualisation.LavaVuModelViewer.add_points" title="LoopStructural.visualisation.LavaVuModelViewer.add_points" class="sphx-glr-backref-module-LoopStructural-visualisation sphx-glr-backref-type-py-method"><span class="n">viewer</span><span class="o">.</span><span class="n">add_points</span></a><span class="p">(</span><a href="../../_autosummary/LoopStructural.modelling.core.geological_model.GeologicalModel.html#LoopStructural.modelling.core.geological_model.GeologicalModel.data" title="LoopStructural.modelling.core.geological_model.GeologicalModel.data" class="sphx-glr-backref-module-LoopStructural-modelling-core-geological_model sphx-glr-backref-type-py-attribute"><span class="n">model</span><span class="o">.</span><span class="n">data</span></a><span class="p">[</span><a href="../../_autosummary/LoopStructural.modelling.core.geological_model.GeologicalModel.html#LoopStructural.modelling.core.geological_model.GeologicalModel.data" title="LoopStructural.modelling.core.geological_model.GeologicalModel.data" class="sphx-glr-backref-module-LoopStructural-modelling-core-geological_model sphx-glr-backref-type-py-attribute"><span class="n">model</span><span class="o">.</span><span class="n">data</span></a><span class="p">[</span><span class="s1">&#39;feature_name&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;strati&#39;</span><span class="p">][[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">]],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;prefault&#39;</span><span class="p">)</span>
<a href="../../_autosummary/LoopStructural.visualisation.LavaVuModelViewer.html#LoopStructural.visualisation.LavaVuModelViewer.rotation" title="LoopStructural.visualisation.LavaVuModelViewer.rotation" class="sphx-glr-backref-module-LoopStructural-visualisation sphx-glr-backref-type-py-method"><span class="n">viewer</span><span class="o">.</span><span class="n">rotation</span></a> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">73.24819946289062</span><span class="p">,</span> <span class="o">-</span><span class="mf">86.82220458984375</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.912878036499023</span><span class="p">]</span>
<a href="../../_autosummary/LoopStructural.visualisation.LavaVuModelViewer.html#LoopStructural.visualisation.LavaVuModelViewer.display" title="LoopStructural.visualisation.LavaVuModelViewer.display" class="sphx-glr-backref-module-LoopStructural-visualisation sphx-glr-backref-type-py-method"><span class="n">viewer</span><span class="o">.</span><span class="n">display</span></a><span class="p">()</span>



<span class="n">displacement</span> <span class="o">=</span> <span class="mi">400</span><span class="c1">#INSERT YOUR DISPLACEMENT NUMBER HERE BEFORE #</span>

<a href="../../_autosummary/LoopStructural.modelling.core.geological_model.GeologicalModel.html#LoopStructural.modelling.core.geological_model.GeologicalModel" title="LoopStructural.modelling.core.geological_model.GeologicalModel" class="sphx-glr-backref-module-LoopStructural-modelling-core-geological_model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model</span></a> <span class="o">=</span> <a href="../../_autosummary/LoopStructural.modelling.core.geological_model.GeologicalModel.html#LoopStructural.modelling.core.geological_model.GeologicalModel" title="LoopStructural.modelling.core.geological_model.GeologicalModel" class="sphx-glr-backref-module-LoopStructural-modelling-core-geological_model sphx-glr-backref-type-py-class"><span class="n">GeologicalModel</span></a><span class="p">(</span><span class="n">bb</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="n">bb</span><span class="p">[</span><span class="mi">1</span><span class="p">,:])</span>
<a href="../../_autosummary/LoopStructural.modelling.core.geological_model.GeologicalModel.html#LoopStructural.modelling.core.geological_model.GeologicalModel" title="LoopStructural.modelling.core.geological_model.GeologicalModel" class="sphx-glr-backref-module-LoopStructural-modelling-core-geological_model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model</span></a><span class="o">.</span><span class="n">set_model_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a href="../../_autosummary/LoopStructural.modelling.fault.FaultSegment.html#LoopStructural.modelling.fault.FaultSegment" title="LoopStructural.modelling.fault.FaultSegment" class="sphx-glr-backref-module-LoopStructural-modelling-fault sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fault</span></a> <span class="o">=</span> <a href="../../_autosummary/LoopStructural.modelling.core.geological_model.GeologicalModel.html#LoopStructural.modelling.core.geological_model.GeologicalModel.create_and_add_fault" title="LoopStructural.modelling.core.geological_model.GeologicalModel.create_and_add_fault" class="sphx-glr-backref-module-LoopStructural-modelling-core-geological_model sphx-glr-backref-type-py-method"><span class="n">model</span><span class="o">.</span><span class="n">create_and_add_fault</span></a><span class="p">(</span><span class="s1">&#39;fault&#39;</span><span class="p">,</span>
                                   <span class="n">displacement</span><span class="p">,</span>
                                   <span class="n">nelements</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span>
                                   <span class="n">steps</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                                   <span class="n">interpolatortype</span><span class="o">=</span><span class="s1">&#39;PLI&#39;</span><span class="p">,</span>
                                  <span class="n">buffer</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a href="../../_autosummary/LoopStructural.modelling.features.GeologicalFeature.html#LoopStructural.modelling.features.GeologicalFeature" title="LoopStructural.modelling.features.GeologicalFeature" class="sphx-glr-backref-module-LoopStructural-modelling-features sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">strati</span></a> <span class="o">=</span> <a href="../../_autosummary/LoopStructural.modelling.core.geological_model.GeologicalModel.html#LoopStructural.modelling.core.geological_model.GeologicalModel.create_and_add_foliation" title="LoopStructural.modelling.core.geological_model.GeologicalModel.create_and_add_foliation" class="sphx-glr-backref-module-LoopStructural-modelling-core-geological_model sphx-glr-backref-type-py-method"><span class="n">model</span><span class="o">.</span><span class="n">create_and_add_foliation</span></a><span class="p">(</span><span class="s1">&#39;strati&#39;</span><span class="p">,</span><span class="n">nelements</span><span class="o">=</span><span class="mi">30000</span><span class="p">,</span><span class="n">interpolatortype</span><span class="o">=</span><span class="s1">&#39;PLI&#39;</span><span class="p">,</span><span class="n">cgw</span><span class="o">=</span><span class="mf">0.03</span><span class="p">)</span>
<a href="../../_autosummary/LoopStructural.modelling.core.geological_model.GeologicalModel.html#LoopStructural.modelling.core.geological_model.GeologicalModel" title="LoopStructural.modelling.core.geological_model.GeologicalModel" class="sphx-glr-backref-module-LoopStructural-modelling-core-geological_model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model</span></a><span class="o">.</span><span class="n">update</span><span class="p">()</span>
<a href="../../_autosummary/LoopStructural.visualisation.LavaVuModelViewer.html#LoopStructural.visualisation.LavaVuModelViewer" title="LoopStructural.visualisation.LavaVuModelViewer" class="sphx-glr-backref-module-LoopStructural-visualisation sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">viewer</span></a> <span class="o">=</span> <a href="../../_autosummary/LoopStructural.visualisation.LavaVuModelViewer.html#LoopStructural.visualisation.LavaVuModelViewer" title="LoopStructural.visualisation.LavaVuModelViewer" class="sphx-glr-backref-module-LoopStructural-visualisation sphx-glr-backref-type-py-class"><span class="n">LavaVuModelViewer</span></a><span class="p">(</span><a href="../../_autosummary/LoopStructural.modelling.core.geological_model.GeologicalModel.html#LoopStructural.modelling.core.geological_model.GeologicalModel" title="LoopStructural.modelling.core.geological_model.GeologicalModel" class="sphx-glr-backref-module-LoopStructural-modelling-core-geological_model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model</span></a><span class="p">)</span>
<a href="../../_autosummary/LoopStructural.visualisation.LavaVuModelViewer.html#LoopStructural.visualisation.LavaVuModelViewer.add_isosurface" title="LoopStructural.visualisation.LavaVuModelViewer.add_isosurface" class="sphx-glr-backref-module-LoopStructural-visualisation sphx-glr-backref-type-py-method"><span class="n">viewer</span><span class="o">.</span><span class="n">add_isosurface</span></a><span class="p">(</span><a href="../../_autosummary/LoopStructural.modelling.features.GeologicalFeature.html#LoopStructural.modelling.features.GeologicalFeature" title="LoopStructural.modelling.features.GeologicalFeature" class="sphx-glr-backref-module-LoopStructural-modelling-features sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">strati</span></a><span class="p">,</span>

                     <span class="n">isovalue</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># viewer.add_data(model.features[0][0])</span>
<a href="../../_autosummary/LoopStructural.visualisation.LavaVuModelViewer.html#LoopStructural.visualisation.LavaVuModelViewer.add_data" title="LoopStructural.visualisation.LavaVuModelViewer.add_data" class="sphx-glr-backref-module-LoopStructural-visualisation sphx-glr-backref-type-py-method"><span class="n">viewer</span><span class="o">.</span><span class="n">add_data</span></a><span class="p">(</span><a href="../../_autosummary/LoopStructural.modelling.features.GeologicalFeature.html#LoopStructural.modelling.features.GeologicalFeature" title="LoopStructural.modelling.features.GeologicalFeature" class="sphx-glr-backref-module-LoopStructural-modelling-features sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">strati</span></a><span class="p">)</span>
<a href="../../_autosummary/LoopStructural.visualisation.LavaVuModelViewer.html#LoopStructural.visualisation.LavaVuModelViewer.add_isosurface" title="LoopStructural.visualisation.LavaVuModelViewer.add_isosurface" class="sphx-glr-backref-module-LoopStructural-visualisation sphx-glr-backref-type-py-method"><span class="n">viewer</span><span class="o">.</span><span class="n">add_isosurface</span></a><span class="p">(</span><a href="../../_autosummary/LoopStructural.modelling.fault.FaultSegment.html#LoopStructural.modelling.fault.FaultSegment" title="LoopStructural.modelling.fault.FaultSegment" class="sphx-glr-backref-module-LoopStructural-modelling-fault sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fault</span></a><span class="p">,</span><span class="n">isovalue</span><span class="o">=</span><span class="mi">0</span>
<span class="c1">#                       slices=[0,1]#nslices=10</span>
                     <span class="p">)</span>
<a href="../../_autosummary/LoopStructural.visualisation.LavaVuModelViewer.html#LoopStructural.visualisation.LavaVuModelViewer.add_points" title="LoopStructural.visualisation.LavaVuModelViewer.add_points" class="sphx-glr-backref-module-LoopStructural-visualisation sphx-glr-backref-type-py-method"><span class="n">viewer</span><span class="o">.</span><span class="n">add_points</span></a><span class="p">(</span><a href="../../_autosummary/LoopStructural.modelling.core.geological_model.GeologicalModel.html#LoopStructural.modelling.core.geological_model.GeologicalModel.data" title="LoopStructural.modelling.core.geological_model.GeologicalModel.data" class="sphx-glr-backref-module-LoopStructural-modelling-core-geological_model sphx-glr-backref-type-py-attribute"><span class="n">model</span><span class="o">.</span><span class="n">data</span></a><span class="p">[</span><a href="../../_autosummary/LoopStructural.modelling.core.geological_model.GeologicalModel.html#LoopStructural.modelling.core.geological_model.GeologicalModel.data" title="LoopStructural.modelling.core.geological_model.GeologicalModel.data" class="sphx-glr-backref-module-LoopStructural-modelling-core-geological_model sphx-glr-backref-type-py-attribute"><span class="n">model</span><span class="o">.</span><span class="n">data</span></a><span class="p">[</span><span class="s1">&#39;feature_name&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;strati&#39;</span><span class="p">][[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">]],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;prefault&#39;</span><span class="p">)</span>
<a href="../../_autosummary/LoopStructural.visualisation.LavaVuModelViewer.html#LoopStructural.visualisation.LavaVuModelViewer.rotation" title="LoopStructural.visualisation.LavaVuModelViewer.rotation" class="sphx-glr-backref-module-LoopStructural-visualisation sphx-glr-backref-type-py-method"><span class="n">viewer</span><span class="o">.</span><span class="n">rotation</span></a> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">73.24819946289062</span><span class="p">,</span> <span class="o">-</span><span class="mf">86.82220458984375</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.912878036499023</span><span class="p">]</span>
<a href="../../_autosummary/LoopStructural.visualisation.LavaVuModelViewer.html#LoopStructural.visualisation.LavaVuModelViewer.display" title="LoopStructural.visualisation.LavaVuModelViewer.display" class="sphx-glr-backref-module-LoopStructural-visualisation sphx-glr-backref-type-py-method"><span class="n">viewer</span><span class="o">.</span><span class="n">display</span></a><span class="p">()</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../../_images/sphx_glr_plot_faulted_intrusion_002.png" srcset="../../_images/sphx_glr_plot_faulted_intrusion_002.png" alt="plot faulted intrusion" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_plot_faulted_intrusion_003.png" srcset="../../_images/sphx_glr_plot_faulted_intrusion_003.png" alt="plot faulted intrusion" class = "sphx-glr-multi-img"/></li>
</ul>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>  0%|          | 0/4 [00:00&lt;?, ?it/s]
Interpolating fault:   0%|          | 0/4 [00:00&lt;?, ?it/s]
Interpolating fault:  50%|#####     | 2/4 [00:00&lt;00:00, 13.53it/s]
Interpolating strati:  75%|#######5  | 3/4 [00:00&lt;00:00, 13.53it/s]
Interpolating strati: : 6it [00:16, 13.53it/s]
Interpolating strati: : 7it [00:25,  3.97s/it]
Interpolating strati: : 7it [00:25,  3.64s/it]
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  41.896 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-3-fault-plot-faulted-intrusion-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/2148ac7d2dc7d07b6bb1a1e3759cccd5/plot_faulted_intrusion.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_faulted_intrusion.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/936b214abbe16a5722e3a0d5bff5402a/plot_faulted_intrusion.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_faulted_intrusion.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../2_fold/plot_refolded_folds.html" class="btn btn-neutral float-left" title="2b. Refolded folds" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../contributors_guide.html" class="btn btn-neutral float-right" title="Contribute" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Lachlan Grose.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>