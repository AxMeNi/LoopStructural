
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/2_fold/plot_refolded_folds.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_2_fold_plot_refolded_folds.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_2_fold_plot_refolded_folds.py:


2b. Refolded folds
===================

.. GENERATED FROM PYTHON SOURCE LINES 7-31

.. code-block:: default


    from LoopStructural import GeologicalModel
    from LoopStructural.visualisation import LavaVuModelViewer, RotationAnglePlotter
    from LoopStructural.datasets import load_laurent2016
    import numpy as np
    import pandas as pd
    import glob
    import os
    import matplotlib.pyplot as plt
    import logging
    # logging.getLogger().setLevel(logging.INFO)

    # load in the data from the provided examples
    data, bb = load_laurent2016()
    # bb[1,2] = 10000

    data.head()

    newdata = pd.DataFrame([[5923.504395,4748.135254,3588.621094,'s2',1.0]],columns=['X','Y','Z','feature_name','val'])
    data = pd.concat([data,newdata],sort=False)

    rotation = [-69.11979675292969, 15.704944610595703, 6.00014591217041]









.. GENERATED FROM PYTHON SOURCE LINES 32-35

Modelling S2
~~~~~~~~~~~~


.. GENERATED FROM PYTHON SOURCE LINES 35-54

.. code-block:: default


    model = GeologicalModel(bb[0,:],bb[1,:])
    model.set_model_data(data)
    s2 = model.create_and_add_fold_frame('s2',
                                         nelements=10000, 
                                         buffer=0.5,
                                        solver='lu',
                                        damp=True)
    viewer = LavaVuModelViewer(model)
    viewer.add_scalar_field(s2[0],
                           cmap='prism')
    viewer.add_isosurface(s2[0],
                         slices=[0,1])
    viewer.add_data(s2[0])
    viewer.rotate(rotation)
    viewer.display()






.. image:: /auto_examples/2_fold/images/sphx_glr_plot_refolded_folds_001.png
    :alt: plot refolded folds
    :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 55-58

Modelling S1
~~~~~~~~~~~~


.. GENERATED FROM PYTHON SOURCE LINES 58-75

.. code-block:: default


    s1 = model.create_and_add_folded_fold_frame('s1',
                                                limb_wl=4, 
                                                av_fold_axis=True,
                                                nelements=50000,
                                                buffer=0.3,
                                                solver='lu'
                                               )



    viewer = LavaVuModelViewer(model)
    viewer.add_scalar_field(s1[0],
                           cmap='prism')
    viewer.rotate([-69.11979675292969, 15.704944610595703, 6.00014591217041])
    viewer.display()




.. image:: /auto_examples/2_fold/images/sphx_glr_plot_refolded_folds_002.png
    :alt: plot refolded folds
    :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 76-79

S2/S1 S-Plots 
~~~~~~~~~~~~~


.. GENERATED FROM PYTHON SOURCE LINES 79-89

.. code-block:: default

    s2_s1_splot = RotationAnglePlotter(s1)
    s2_s1_splot.add_fold_limb_data()
    s2_s1_splot.add_fold_limb_curve()  
    # fig, ax = plt.subplots(1,2,figsize=(10,5))
    # x = np.linspace(s2[0].min(),s2[0].max(),1000)
    # ax[0].plot(x,s1['fold'].fold_limb_rotation(x))
    # ax[0].plot(s1['fold'].fold_limb_rotation.fold_frame_coordinate,s1['fold'].fold_limb_rotation.rotation_angle,'bo')
    # ax[1].plot(s1['limb_svariogram'].lags,s1['limb_svariogram'].variogram,'bo')





.. image:: /auto_examples/2_fold/images/sphx_glr_plot_refolded_folds_003.png
    :alt: plot refolded folds
    :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    [<matplotlib.lines.Line2D object at 0x7f4900f96730>]



.. GENERATED FROM PYTHON SOURCE LINES 90-93

Modelling S0
~~~~~~~~~~~~


.. GENERATED FROM PYTHON SOURCE LINES 93-109

.. code-block:: default


    s0 = model.create_and_add_folded_foliation('s0',
                                                limb_wl=1., 
                                                av_fold_axis=True,
                                                nelements=50000,
                                                buffer=0.2,
                                                damp=True,
                                               solver='lu'
                                               )

    viewer = LavaVuModelViewer(model)
    viewer.add_scalar_field(s0,
                           cmap='tab20')
    viewer.rotate([-69.11979675292969, 15.704944610595703, 6.00014591217041])
    viewer.display()




.. image:: /auto_examples/2_fold/images/sphx_glr_plot_refolded_folds_004.png
    :alt: plot refolded folds
    :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 110-113

S1/S0 S-Plots 
~~~~~~~~~~~~~


.. GENERATED FROM PYTHON SOURCE LINES 113-130

.. code-block:: default

    s1_s0_splot = RotationAnglePlotter(s0)
    s1_s0_splot.add_fold_limb_data()
    s1_s0_splot.add_fold_limb_curve()

    # fig, ax = plt.subplots(1,2,figsize=(10,5))
    # x = np.linspace(s1[0].min(),s1[0].max(),1000)
    # ax[0].plot(x,s0['fold'].fold_limb_rotation(x))
    # ax[0].plot(s0['fold'].fold_limb_rotation.fold_frame_coordinate,s0['fold'].fold_limb_rotation.rotation_angle,'bo')
    # ax[1].plot(s0['limb_svariogram'].lags,s1['limb_svariogram'].variogram,'bo')

    viewer = LavaVuModelViewer(model)
    viewer.add_isosurface(s0,nslices=10,paint_with=s0,cmap='tab20')
    # viewer.add_data(s0)
    # viewer.add_fold(s0['fold'],locations=s0['support'].barycentre()[::80])
    viewer.rotate([-69.11979675292969, 15.704944610595703, 6.00014591217041])
    viewer.display()




.. image:: /auto_examples/2_fold/images/sphx_glr_plot_refolded_folds_005.png
    :alt: plot refolded folds
    :class: sphx-glr-single-img

.. image:: /auto_examples/2_fold/images/sphx_glr_plot_refolded_folds_006.png
    :alt: plot refolded folds
    :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  24.218 seconds)


.. _sphx_glr_download_auto_examples_2_fold_plot_refolded_folds.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_refolded_folds.py <plot_refolded_folds.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_refolded_folds.ipynb <plot_refolded_folds.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
