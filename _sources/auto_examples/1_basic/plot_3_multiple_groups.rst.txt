
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/1_basic/plot_3_multiple_groups.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_1_basic_plot_3_multiple_groups.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_1_basic_plot_3_multiple_groups.py:


1c. Multiple groups
===================
Creating a model with multiple geological features, dealing with unconformities.

.. GENERATED FROM PYTHON SOURCE LINES 7-49



.. image:: /auto_examples/1_basic/images/sphx_glr_plot_3_multiple_groups_001.png
    :alt: plot 3 multiple groups
    :class: sphx-glr-single-img





.. code-block:: default

    from LoopStructural import GeologicalModel
    from LoopStructural.datasets import load_claudius
    from LoopStructural.visualisation import LavaVuModelViewer

    import pandas as pd
    import numpy as np

    data, bb = load_claudius()
    data = data.reset_index()

    data.loc[:,'val']*=-1
    data.loc[:,['nx','ny','nz']]*=-1

    data.loc[792,'feature_name'] = 'strati2'
    data.loc[792,['nx','ny','nz']] = [0,0,1]
    data.loc[792,'val'] = 0

    model = GeologicalModel(bb[0,:],bb[1,:])
    model.set_model_data(data)

    strati2 = model.create_and_add_foliation('strati2',
                                  interpolatortype='PLI',
                                   nelements=1e4,
                                   solver='pyamg'
                                  )
    uc = model.add_unconformity(strati2,1)

    strati = model.create_and_add_foliation('strati',
                                  interpolatortype='PLI',
                                   nelements=1e4,
                                   solver='pyamg'
                                  )

    viewer = LavaVuModelViewer(model)
    viewer.add_isosurface(strati2,
    #                       nslices=5
                          slices=[2,1.5,1],
                         )
    viewer.add_isosurface(strati,
                          slices=[0,-60,-250,-330],
                         paint_with=strati)
    viewer.rotate([-85.18760681152344, 42.93233871459961, 0.8641873002052307])
    viewer.display()

.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  3.477 seconds)


.. _sphx_glr_download_auto_examples_1_basic_plot_3_multiple_groups.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_3_multiple_groups.py <plot_3_multiple_groups.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_3_multiple_groups.ipynb <plot_3_multiple_groups.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
