
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>2a. Modelling folds &#8212; LoopStructural 0.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../../_static/styles/bootstrap.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=796348d33e8b1d947c94" rel="stylesheet">
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94">
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '_auto_examples/2_fold/plot_adding_folds_to_surfaces';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="2b. Refolded folds" href="plot_refolded_folds.html" />
    <link rel="prev" title="2. Modelling Folds" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>

  
  <input type="checkbox" class="sidebar-toggle" name="__primary" id="__primary">
  <label class="overlay overlay-primary" for="__primary"></label>

  
  <input type="checkbox" class="sidebar-toggle" name="__secondary" id="__secondary">
  <label class="overlay overlay-secondary" for="__secondary"></label>

  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
      
<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  </div>

  
  <nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
      <span class="fa-solid fa-bars"></span>
  </label>
  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../../index.html">

  
  
  
  
  
  
  

  
  
    <p class="title logo__title">LoopStructural 0.1 documentation</p>
  
</a>
    
  </div>

  
  <div class="col-lg-9 navbar-header-items">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../getting_started/index.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../user_guide/index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../_autosummary/LoopStructural.html">
                        LoopStructural
                      </a>
                    </li>
                

                <li class="nav-item">
                  <a class="nav-link nav-external" href="https://www.loop3d.org">
                    Loop3d
                  </a>
                </li>
                
    </ul>
</nav>
      </div>
      
    </div>

    <div id="navbar-end">
      
        <div class="navbar-end-item navbar-persistent--container">
          
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
        </div>
      
      
      <div class="navbar-end-item">
        <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/loop3d/LoopStructural" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://twitter.com/loop3d" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>


  
  
    <div class="navbar-persistent--mobile">
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
    </div>
  

  
  <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
  </label>
  

</div>
  </nav>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        
  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../getting_started/index.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../user_guide/index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../_autosummary/LoopStructural.html">
                        LoopStructural
                      </a>
                    </li>
                

                <li class="nav-item">
                  <a class="nav-link nav-external" href="https://www.loop3d.org">
                    Loop3d
                  </a>
                </li>
                
    </ul>
</nav>
      </div>
      
      </div>
    

    
    
    <div class="sidebar-header-items__end">
      
      <div class="navbar-end-item">
        <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/loop3d/LoopStructural" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://twitter.com/loop3d" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
      </ul>
      </div>
      
    </div>
    
  </div>

  
  <div class="sidebar-start-items sidebar-primary__section">
    <div class="sidebar-start-items__item"><nav class="bd-links" id="bd-docs-nav" aria-label="Section navigation">
  <p class="bd-links__title" role="heading" aria-level="1">
    Section Navigation
  </p>
  <div class="bd-toc-item navbar-nav">
    <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../1_basic/index.html">1. Basics</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../1_basic/least_squares.html">1a. Advanced least squares</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_basic/plot_1_data_prepration.html">1a. Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_basic/plot_2_surface_modelling.html">1b. Implicit surface modelling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_basic/plot_3_multiple_groups.html">1c. Multiple groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_basic/plot_3_model_visualisation.html">1c. Visualising models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_basic/plot_4_using_stratigraphic_column.html">1d. Using Stratigraphic Columns</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_basic/plot_5_using_logging.html">1e. Using logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_basic/scalar_field.html">1f. Implicit modelling: signed distance field</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_basic/plot_7_local_weights.html">1f. Local data weighting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_basic/example_surfe.html">1f. Radial Basis Interpolation Using Surfe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_basic/plot_6_unconformities.html">1f. Unconformities</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">2. Modelling Folds</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">2a. Modelling folds</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_refolded_folds.html">2b. Refolded folds</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../3_fault/index.html">3. Modelling Faults</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../3_fault/plot_faulted_intrusion.html">3a. Modelling faults using structural frames</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3_fault/plot_fault_network.html">3b. Modelling a fault network in LoopStructural</a></li>
</ul>
</li>
</ul>

  </div>
</nav>
    </div>
  </div>
  

  
  <div class="sidebar-end-items sidebar-primary__section">
    <div class="sidebar-end-items__item">
    </div>
  </div>

  
  <div id="rtd-footer-container"></div>

      </div>
      <main id="main-content" class="bd-main">
        
        
        <div class="bd-content">
          <div class="bd-article-container">
            
            <div class="bd-header-article">
                
            </div>
            
            
            <article class="bd-article" role="main">
              
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-2-fold-plot-adding-folds-to-surfaces-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="a-modelling-folds">
<span id="sphx-glr-auto-examples-2-fold-plot-adding-folds-to-surfaces-py"></span><h1>2a. Modelling folds<a class="headerlink" href="#a-modelling-folds" title="Permalink to this heading">#</a></h1>
<blockquote>
<div><p>This tutorial will show how Loop Structural improves the modelling of
folds by using an accurate parameterization of folds geometry. This will
be done by: 1. Modelling folded surfaces without structural geology,
i.e. using only data points and adjusting the scalar fields to those
points. 2. Modelling folds using structural geology, which includes: *
Description of local fold frame and rotation angles calculation *
Construction of folded foliations using fold geostatistics inside the
fold frame coordinate system</p>
</div></blockquote>
<div class="section" id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Permalink to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">LoopStructural</span> <span class="kn">import</span> <a href="../../_autosummary/LoopStructural.modelling.core.geological_model.GeologicalModel.html#LoopStructural.modelling.core.geological_model.GeologicalModel" title="LoopStructural.modelling.core.geological_model.GeologicalModel" class="sphx-glr-backref-module-LoopStructural-modelling-core-geological_model sphx-glr-backref-type-py-class"><span class="n">GeologicalModel</span></a>
<span class="kn">from</span> <span class="nn">LoopStructural.datasets</span> <span class="kn">import</span> <a href="../../_autosummary/LoopStructural.datasets.load_noddy_single_fold.html#LoopStructural.datasets.load_noddy_single_fold" title="LoopStructural.datasets.load_noddy_single_fold" class="sphx-glr-backref-module-LoopStructural-datasets sphx-glr-backref-type-py-function"><span class="n">load_noddy_single_fold</span></a>
<span class="kn">from</span> <span class="nn">LoopStructural.visualisation</span> <span class="kn">import</span> <a href="../../_autosummary/LoopStructural.visualisation.LavaVuModelViewer.html#LoopStructural.visualisation.LavaVuModelViewer" title="LoopStructural.visualisation.LavaVuModelViewer" class="sphx-glr-backref-module-LoopStructural-visualisation sphx-glr-backref-type-py-class"><span class="n">LavaVuModelViewer</span></a><span class="p">,</span> <a href="../../_autosummary/LoopStructural.visualisation.RotationAnglePlotter.html#LoopStructural.visualisation.RotationAnglePlotter" title="LoopStructural.visualisation.RotationAnglePlotter" class="sphx-glr-backref-module-LoopStructural-visualisation sphx-glr-backref-type-py-class"><span class="n">RotationAnglePlotter</span></a>
<span class="kn">from</span> <span class="nn">LoopStructural.utils.helper</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">strike_dip_vector</span><span class="p">,</span>
    <span class="n">plunge_and_plunge_dir_to_vector</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">Rbf</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
<div class="section" id="structural-geology-of-folds">
<h2>Structural geology of folds<a class="headerlink" href="#structural-geology-of-folds" title="Permalink to this heading">#</a></h2>
<p>Folds are one of the most common features found in deformed rocks and
are defined by the location of higher curvature. The geometry of the
folded surface can be characterised by three geometrical elements:</p>
<ol class="arabic simple">
<li><p>the fold hinge is the point of maximum curvature along folded surface</p></li>
<li><p>the axial surface is a surfaces that passes through all curvature
points in all folded foliations</p></li>
<li><p>the fold axis is the intersection of the folded foliation and the
axial surface</p></li>
</ol>
<p>Modelling folded surfaces using standard implicit algorithms is
challenging because the implicit modelling methods are generally trying
to minimise the resulting curvature of the surface. To model folded
surfaces the geologist will need to characterise the geometry of the
folded surface in high detail.</p>
</div>
<div class="section" id="modelling-folded-surfaces-without-structural-geology">
<h2>Modelling folded surfaces without structural geology<a class="headerlink" href="#modelling-folded-surfaces-without-structural-geology" title="Permalink to this heading">#</a></h2>
<p>In the following section we will attempt to model a synthetic fold shape
that is defined by a sinusoidal folded surface. For simplicity we will
consider the fold as cylindrical and therefore only consider the fold in
a 2D plane. The data set has been sampled from a model generated using
Noddy and represents a fold with a wavelength of ~10km and amplitude of
~2km.</p>
<p>The orientation of the structure has been sampled within the model
volume (10km,7km,5km) at 500m intervals.</p>
<p><strong>The aim of this exercise is to investigate how standard implicit
modelling techniques are fundamentally limited when trying to model
folded surfaces.</strong></p>
<ol class="arabic simple">
<li><p>Load data from sample datasets</p></li>
<li><p>Visualise data</p></li>
<li><p>Look at varying degrees of sampling e.g. 200 points, 100 points, 10
points.</p></li>
<li><p>Look at using data points ONLY from a map surface</p></li>
</ol>
<div class="section" id="modelling-folded-surfaces-using-loop-structural">
<h3>Modelling folded surfaces using loop structural<a class="headerlink" href="#modelling-folded-surfaces-using-loop-structural" title="Permalink to this heading">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># load the sample data</span>
<span class="n">data</span><span class="p">,</span> <span class="n">boundary_points</span> <span class="o">=</span> <a href="../../_autosummary/LoopStructural.datasets.load_noddy_single_fold.html#LoopStructural.datasets.load_noddy_single_fold" title="LoopStructural.datasets.load_noddy_single_fold" class="sphx-glr-backref-module-LoopStructural-datasets sphx-glr-backref-type-py-function"><span class="n">load_noddy_single_fold</span></a><span class="p">()</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>X</th>
      <th>Y</th>
      <th>Z</th>
      <th>dip</th>
      <th>strike</th>
      <th>feature_name</th>
      <th>coord</th>
      <th>random</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>972</td>
      <td>500.0</td>
      <td>500.0</td>
      <td>5500.0</td>
      <td>69.965373</td>
      <td>399.166448</td>
      <td>s0</td>
      <td>NaN</td>
      <td>0.126657</td>
    </tr>
    <tr>
      <th>1</th>
      <td>976</td>
      <td>500.0</td>
      <td>500.0</td>
      <td>6000.0</td>
      <td>69.965373</td>
      <td>399.166448</td>
      <td>s0</td>
      <td>NaN</td>
      <td>0.376144</td>
    </tr>
    <tr>
      <th>2</th>
      <td>980</td>
      <td>500.0</td>
      <td>500.0</td>
      <td>6500.0</td>
      <td>69.965373</td>
      <td>399.166448</td>
      <td>s0</td>
      <td>NaN</td>
      <td>0.731684</td>
    </tr>
    <tr>
      <th>3</th>
      <td>984</td>
      <td>500.0</td>
      <td>500.0</td>
      <td>7000.0</td>
      <td>69.965373</td>
      <td>399.166448</td>
      <td>s0</td>
      <td>NaN</td>
      <td>0.479522</td>
    </tr>
    <tr>
      <th>4</th>
      <td>988</td>
      <td>500.0</td>
      <td>500.0</td>
      <td>7500.0</td>
      <td>69.965373</td>
      <td>399.166448</td>
      <td>s0</td>
      <td>NaN</td>
      <td>0.465607</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<br />
<br /><p>The input dataset was generated using Noddy by sampling the orientation
of a structure on a regular grid. We have loaded it into a pandas
DataFrame, this is basically an excel spreadsheet for python. Above are
the first 5 rows of the dataset and as we can see it is regularly
sampled with data points being sampled regularly along the <span class="math notranslate nohighlight">\(z\)</span>,
<span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(x\)</span> axes. In order to avoid artefacts due to the
sampling errors we will shuffle the data. We can do this using the
<code class="docutils literal notranslate"><span class="pre">random</span></code> column in the DataFrame (ensuring everyone has the same
data).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
    <span class="s2">&quot;random&quot;</span>
<span class="p">)</span>  <span class="c1"># sort the data by a random int then we can select N random points</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>X</th>
      <th>Y</th>
      <th>Z</th>
      <th>dip</th>
      <th>strike</th>
      <th>feature_name</th>
      <th>coord</th>
      <th>random</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1909</th>
      <td>11272</td>
      <td>2000.0</td>
      <td>6000.0</td>
      <td>6000.0</td>
      <td>70.370847</td>
      <td>398.150099</td>
      <td>s0</td>
      <td>NaN</td>
      <td>0.000340</td>
    </tr>
    <tr>
      <th>31</th>
      <td>1120</td>
      <td>2000.0</td>
      <td>500.0</td>
      <td>7500.0</td>
      <td>70.370847</td>
      <td>398.150099</td>
      <td>s0</td>
      <td>NaN</td>
      <td>0.003175</td>
    </tr>
    <tr>
      <th>1926</th>
      <td>11356</td>
      <td>3000.0</td>
      <td>6000.0</td>
      <td>5500.0</td>
      <td>64.030744</td>
      <td>417.522113</td>
      <td>s0</td>
      <td>NaN</td>
      <td>0.004159</td>
    </tr>
    <tr>
      <th>1256</th>
      <td>7724</td>
      <td>3500.0</td>
      <td>4000.0</td>
      <td>8000.0</td>
      <td>64.030744</td>
      <td>417.522113</td>
      <td>s0</td>
      <td>NaN</td>
      <td>0.004213</td>
    </tr>
    <tr>
      <th>859</th>
      <td>5608</td>
      <td>500.0</td>
      <td>3000.0</td>
      <td>7500.0</td>
      <td>69.965373</td>
      <td>399.166448</td>
      <td>s0</td>
      <td>NaN</td>
      <td>0.005269</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<br />
<br /><p>The data points are now randomly ordered and can now be subsampled by
choosing the first N samples from the dataframe</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[:</span><span class="mi">100</span><span class="p">]</span>
</pre></div>
</div>
<p>returns the first 100 data points from the array</p>
</div>
<div class="section" id="testing-data-density">
<h3>Testing data density<a class="headerlink" href="#testing-data-density" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Use the toggle bar to change the amount of data used by the
interpolation algorithm.</p></li>
<li><p>How does the shape of the fold change as we remove data points?</p></li>
<li><p>Now what happens if we only consider data from the map view?</p></li>
</ul>
<p><strong>HINT</strong> you can view the strike and dip data by unchecking the scalar
field box.</p>
<p><strong>The black arrows are the normal vector to the folded surface</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">npoints</span> <span class="o">=</span> <span class="mi">20</span>
<a href="../../_autosummary/LoopStructural.modelling.core.geological_model.GeologicalModel.html#LoopStructural.modelling.core.geological_model.GeologicalModel" title="LoopStructural.modelling.core.geological_model.GeologicalModel" class="sphx-glr-backref-module-LoopStructural-modelling-core-geological_model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model</span></a> <span class="o">=</span> <a href="../../_autosummary/LoopStructural.modelling.core.geological_model.GeologicalModel.html#LoopStructural.modelling.core.geological_model.GeologicalModel" title="LoopStructural.modelling.core.geological_model.GeologicalModel" class="sphx-glr-backref-module-LoopStructural-modelling-core-geological_model sphx-glr-backref-type-py-class"><span class="n">GeologicalModel</span></a><span class="p">(</span><span class="n">boundary_points</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">boundary_points</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
<a href="../../_autosummary/LoopStructural.modelling.core.geological_model.GeologicalModel.html#LoopStructural.modelling.core.geological_model.GeologicalModel" title="LoopStructural.modelling.core.geological_model.GeologicalModel" class="sphx-glr-backref-module-LoopStructural-modelling-core-geological_model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model</span></a><span class="o">.</span><span class="n">set_model_data</span><span class="p">(</span><span class="n">data</span><span class="p">[:</span><span class="n">npoints</span><span class="p">])</span>
<a href="../../_autosummary/LoopStructural.modelling.features.GeologicalFeature.html#LoopStructural.modelling.features.GeologicalFeature" title="LoopStructural.modelling.features.GeologicalFeature" class="sphx-glr-backref-module-LoopStructural-modelling-features sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">stratigraphy</span></a> <span class="o">=</span> <a href="../../_autosummary/LoopStructural.modelling.core.geological_model.GeologicalModel.html#LoopStructural.modelling.core.geological_model.GeologicalModel.create_and_add_foliation" title="LoopStructural.modelling.core.geological_model.GeologicalModel.create_and_add_foliation" class="sphx-glr-backref-module-LoopStructural-modelling-core-geological_model sphx-glr-backref-type-py-method"><span class="n">model</span><span class="o">.</span><span class="n">create_and_add_foliation</span></a><span class="p">(</span>
    <span class="s2">&quot;s0&quot;</span><span class="p">,</span> <span class="n">interpolatortype</span><span class="o">=</span><span class="s2">&quot;PLI&quot;</span><span class="p">,</span> <span class="n">nelements</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">buffer</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">cgw</span><span class="o">=</span><span class="mf">0.1</span>
<span class="p">)</span>  <span class="c1"># .2)</span>
<a href="../../_autosummary/LoopStructural.visualisation.LavaVuModelViewer.html#LoopStructural.visualisation.LavaVuModelViewer" title="LoopStructural.visualisation.LavaVuModelViewer" class="sphx-glr-backref-module-LoopStructural-visualisation sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">viewer</span></a> <span class="o">=</span> <a href="../../_autosummary/LoopStructural.visualisation.LavaVuModelViewer.html#LoopStructural.visualisation.LavaVuModelViewer" title="LoopStructural.visualisation.LavaVuModelViewer" class="sphx-glr-backref-module-LoopStructural-visualisation sphx-glr-backref-type-py-class"><span class="n">LavaVuModelViewer</span></a><span class="p">(</span><a href="../../_autosummary/LoopStructural.modelling.core.geological_model.GeologicalModel.html#LoopStructural.modelling.core.geological_model.GeologicalModel" title="LoopStructural.modelling.core.geological_model.GeologicalModel" class="sphx-glr-backref-module-LoopStructural-modelling-core-geological_model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model</span></a><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
<span class="c1"># viewer.add_scalar_field(model.bounding_box,(38,55,30),</span>
<span class="c1">#                       &#39;box&#39;,</span>
<span class="c1">#                      paint_with=stratigraphy,</span>
<span class="c1">#                      cmap=&#39;prism&#39;)</span>
<a href="../../_autosummary/LoopStructural.visualisation.LavaVuModelViewer.html#LoopStructural.visualisation.LavaVuModelViewer.add_data" title="LoopStructural.visualisation.LavaVuModelViewer.add_data" class="sphx-glr-backref-module-LoopStructural-visualisation sphx-glr-backref-type-py-method"><span class="n">viewer</span><span class="o">.</span><span class="n">add_data</span></a><span class="p">(</span><a href="../../_autosummary/LoopStructural.modelling.features.GeologicalFeature.html#LoopStructural.modelling.features.GeologicalFeature" title="LoopStructural.modelling.features.GeologicalFeature" class="sphx-glr-backref-module-LoopStructural-modelling-features sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">stratigraphy</span></a><span class="p">)</span>
<a href="../../_autosummary/LoopStructural.visualisation.LavaVuModelViewer.html#LoopStructural.visualisation.LavaVuModelViewer.add_isosurface" title="LoopStructural.visualisation.LavaVuModelViewer.add_isosurface" class="sphx-glr-backref-module-LoopStructural-visualisation sphx-glr-backref-type-py-method"><span class="n">viewer</span><span class="o">.</span><span class="n">add_isosurface</span></a><span class="p">(</span>
    <a href="../../_autosummary/LoopStructural.modelling.features.GeologicalFeature.html#LoopStructural.modelling.features.GeologicalFeature" title="LoopStructural.modelling.features.GeologicalFeature" class="sphx-glr-backref-module-LoopStructural-modelling-features sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">stratigraphy</span></a><span class="p">,</span>
<span class="p">)</span>
<a href="../../_autosummary/LoopStructural.visualisation.LavaVuModelViewer.html#LoopStructural.visualisation.LavaVuModelViewer.rotate" title="LoopStructural.visualisation.LavaVuModelViewer.rotate" class="sphx-glr-backref-module-LoopStructural-visualisation sphx-glr-backref-type-py-method"><span class="n">viewer</span><span class="o">.</span><span class="n">rotate</span></a><span class="p">([</span><span class="o">-</span><span class="mf">85.18760681152344</span><span class="p">,</span> <span class="mf">42.93233871459961</span><span class="p">,</span> <span class="mf">0.8641873002052307</span><span class="p">])</span>
<a href="../../_autosummary/LoopStructural.visualisation.LavaVuModelViewer.html#LoopStructural.visualisation.LavaVuModelViewer.display" title="LoopStructural.visualisation.LavaVuModelViewer.display" class="sphx-glr-backref-module-LoopStructural-visualisation sphx-glr-backref-type-py-method"><span class="n">viewer</span><span class="o">.</span><span class="n">display</span></a><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_adding_folds_to_surfaces_001.png" srcset="../../_images/sphx_glr_plot_adding_folds_to_surfaces_001.png" alt="plot adding folds to surfaces" class = "sphx-glr-single-img"/></div>
<div class="section" id="modelling-folds-using-structural-geology">
<h3>Modelling folds using structural geology<a class="headerlink" href="#modelling-folds-using-structural-geology" title="Permalink to this heading">#</a></h3>
<p>The following section will describe how the fold axis, fold axial
surface and fold vergence can be used to help constrain the shape of the
folded surface. To do this we need to build a fold frame which is
curvilinear coordinate system based around the fold axis and the fold
axial surface.</p>
<p>There are three coordinates to the fold frame: * coordinate 0 is the
axial surface of the fold and is parallel to the axial foliation *
coordinate 1 is the fold axis direction field and is orthogonal to the
axial foliation * coordinate 2 is orthogonal to both the fold axis
direction field and axial foliation and is roughly parallel to the
extension direction of the fold</p>
<p>Three direction vectors are defined by the normalised gradient of these
fields: * <span class="math notranslate nohighlight">\(e_0\)</span> - red * <span class="math notranslate nohighlight">\(e_1\)</span> - green * <span class="math notranslate nohighlight">\(e_2\)</span> -
blue</p>
<p>The orientation of the folded foliation can be defined by rotating
<span class="math notranslate nohighlight">\(e_1\)</span> around <span class="math notranslate nohighlight">\(e_0\)</span> by the fold axis rotation angle
<span class="math notranslate nohighlight">\(\alpha_P\)</span> to give the orientation of the fold axis. The
orientation of the folded foliation can then be defined by rotating the
plane defined by the fold axis and <span class="math notranslate nohighlight">\(e_0\)</span> around the fold axis by
the fold limb rotation angle <span class="math notranslate nohighlight">\(\alpha_L\)</span>.</p>
</div>
<div class="section" id="calculating-the-fold-rotation-angles">
<h3>Calculating the fold rotation angles<a class="headerlink" href="#calculating-the-fold-rotation-angles" title="Permalink to this heading">#</a></h3>
<p>The rotation angles can be calculated for observations of the folded
foliation and assocaited lineations. For example, the fold axis rotation
angle is found by calculating the angle between the gradient of the fold
axis direction field and the intersection lineations shown in A). The
fold limb rotation angle is found by finding the the angle to rotate the
folded foliation to be parallel to the plane of the axial foliation
shown in B and C.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mdata</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">data</span><span class="p">[:</span><span class="n">npoints</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;feature_name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;s1&quot;</span><span class="p">]])</span>
<a href="../../_autosummary/LoopStructural.modelling.core.geological_model.GeologicalModel.html#LoopStructural.modelling.core.geological_model.GeologicalModel" title="LoopStructural.modelling.core.geological_model.GeologicalModel" class="sphx-glr-backref-module-LoopStructural-modelling-core-geological_model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model</span></a> <span class="o">=</span> <a href="../../_autosummary/LoopStructural.modelling.core.geological_model.GeologicalModel.html#LoopStructural.modelling.core.geological_model.GeologicalModel" title="LoopStructural.modelling.core.geological_model.GeologicalModel" class="sphx-glr-backref-module-LoopStructural-modelling-core-geological_model sphx-glr-backref-type-py-class"><span class="n">GeologicalModel</span></a><span class="p">(</span><span class="n">boundary_points</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">boundary_points</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
<a href="../../_autosummary/LoopStructural.modelling.core.geological_model.GeologicalModel.html#LoopStructural.modelling.core.geological_model.GeologicalModel" title="LoopStructural.modelling.core.geological_model.GeologicalModel" class="sphx-glr-backref-module-LoopStructural-modelling-core-geological_model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model</span></a><span class="o">.</span><span class="n">set_model_data</span><span class="p">(</span><span class="n">mdata</span><span class="p">)</span>
<a href="../../_autosummary/LoopStructural.modelling.features.fold.FoldFrame.html#LoopStructural.modelling.features.fold.FoldFrame" title="LoopStructural.modelling.features.fold.FoldFrame" class="sphx-glr-backref-module-LoopStructural-modelling-features-fold sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fold_frame</span></a> <span class="o">=</span> <a href="../../_autosummary/LoopStructural.modelling.core.geological_model.GeologicalModel.html#LoopStructural.modelling.core.geological_model.GeologicalModel.create_and_add_fold_frame" title="LoopStructural.modelling.core.geological_model.GeologicalModel.create_and_add_fold_frame" class="sphx-glr-backref-module-LoopStructural-modelling-core-geological_model sphx-glr-backref-type-py-method"><span class="n">model</span><span class="o">.</span><span class="n">create_and_add_fold_frame</span></a><span class="p">(</span>
    <span class="s2">&quot;s1&quot;</span><span class="p">,</span> <span class="n">interpolatortype</span><span class="o">=</span><span class="s2">&quot;PLI&quot;</span><span class="p">,</span> <span class="n">nelements</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">buffer</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s2">&quot;pyamg&quot;</span><span class="p">,</span> <span class="n">damp</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<a href="../../_autosummary/LoopStructural.modelling.features.GeologicalFeature.html#LoopStructural.modelling.features.GeologicalFeature" title="LoopStructural.modelling.features.GeologicalFeature" class="sphx-glr-backref-module-LoopStructural-modelling-features sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">stratigraphy</span></a> <span class="o">=</span> <a href="../../_autosummary/LoopStructural.modelling.core.geological_model.GeologicalModel.html#LoopStructural.modelling.core.geological_model.GeologicalModel.create_and_add_folded_foliation" title="LoopStructural.modelling.core.geological_model.GeologicalModel.create_and_add_folded_foliation" class="sphx-glr-backref-module-LoopStructural-modelling-core-geological_model sphx-glr-backref-type-py-method"><span class="n">model</span><span class="o">.</span><span class="n">create_and_add_folded_foliation</span></a><span class="p">(</span>
    <span class="s2">&quot;s0&quot;</span><span class="p">,</span>
    <a href="../../_autosummary/LoopStructural.modelling.features.fold.FoldFrame.html#LoopStructural.modelling.features.fold.FoldFrame" title="LoopStructural.modelling.features.fold.FoldFrame" class="sphx-glr-backref-module-LoopStructural-modelling-features-fold sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fold_frame</span></a><span class="p">,</span>
    <span class="n">nelements</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
    <span class="n">fold_axis</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">6.51626577e-06</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.00013645e-01</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.66017526e-01</span><span class="p">],</span>
    <span class="c1">#                                                    limb_wl=1</span>
    <span class="n">buffer</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<span class="p">)</span>
<a href="../../_autosummary/LoopStructural.visualisation.LavaVuModelViewer.html#LoopStructural.visualisation.LavaVuModelViewer" title="LoopStructural.visualisation.LavaVuModelViewer" class="sphx-glr-backref-module-LoopStructural-visualisation sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">viewer</span></a> <span class="o">=</span> <a href="../../_autosummary/LoopStructural.visualisation.LavaVuModelViewer.html#LoopStructural.visualisation.LavaVuModelViewer" title="LoopStructural.visualisation.LavaVuModelViewer" class="sphx-glr-backref-module-LoopStructural-visualisation sphx-glr-backref-type-py-class"><span class="n">LavaVuModelViewer</span></a><span class="p">(</span><a href="../../_autosummary/LoopStructural.modelling.core.geological_model.GeologicalModel.html#LoopStructural.modelling.core.geological_model.GeologicalModel" title="LoopStructural.modelling.core.geological_model.GeologicalModel" class="sphx-glr-backref-module-LoopStructural-modelling-core-geological_model sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model</span></a><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
<span class="c1"># viewer.add_scalar_field(model.bounding_box,(38,55,30),</span>
<span class="c1">#                       &#39;box&#39;,</span>
<span class="c1">#                      paint_with=stratigraphy,</span>
<span class="c1">#                      cmap=&#39;prism&#39;)</span>
<a href="../../_autosummary/LoopStructural.visualisation.LavaVuModelViewer.html#LoopStructural.visualisation.LavaVuModelViewer.add_isosurface" title="LoopStructural.visualisation.LavaVuModelViewer.add_isosurface" class="sphx-glr-backref-module-LoopStructural-visualisation sphx-glr-backref-type-py-method"><span class="n">viewer</span><span class="o">.</span><span class="n">add_isosurface</span></a><span class="p">(</span>
    <a href="../../_autosummary/LoopStructural.modelling.features.fold.FoldFrame.html#LoopStructural.modelling.features.fold.FoldFrame" title="LoopStructural.modelling.features.fold.FoldFrame" class="sphx-glr-backref-module-LoopStructural-modelling-features-fold sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fold_frame</span></a><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">colour</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span>
    <span class="c1">#                       isovalue=0.4,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<span class="p">)</span>
<a href="../../_autosummary/LoopStructural.visualisation.LavaVuModelViewer.html#LoopStructural.visualisation.LavaVuModelViewer.add_data" title="LoopStructural.visualisation.LavaVuModelViewer.add_data" class="sphx-glr-backref-module-LoopStructural-visualisation sphx-glr-backref-type-py-method"><span class="n">viewer</span><span class="o">.</span><span class="n">add_data</span></a><span class="p">(</span><a href="../../_autosummary/LoopStructural.modelling.features.GeologicalFeature.html#LoopStructural.modelling.features.GeologicalFeature" title="LoopStructural.modelling.features.GeologicalFeature" class="sphx-glr-backref-module-LoopStructural-modelling-features sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">stratigraphy</span></a><span class="p">)</span>
<span class="c1"># viewer.add_isosurface(fold_frame[1],colour=&#39;green&#39;,alpha=0.5)</span>
<span class="c1"># viewer.add_vector_field(fold_frame[0],locations=fold_frame[0].get_interpolator().support.barycentre)</span>
<span class="c1"># viewer.add_data(fold_frame[1])</span>

<span class="c1"># viewer.add_data(stratigraphy)</span>
<a href="../../_autosummary/LoopStructural.visualisation.LavaVuModelViewer.html#LoopStructural.visualisation.LavaVuModelViewer.add_isosurface" title="LoopStructural.visualisation.LavaVuModelViewer.add_isosurface" class="sphx-glr-backref-module-LoopStructural-visualisation sphx-glr-backref-type-py-method"><span class="n">viewer</span><span class="o">.</span><span class="n">add_isosurface</span></a><span class="p">(</span><a href="../../_autosummary/LoopStructural.modelling.features.GeologicalFeature.html#LoopStructural.modelling.features.GeologicalFeature" title="LoopStructural.modelling.features.GeologicalFeature" class="sphx-glr-backref-module-LoopStructural-modelling-features sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">stratigraphy</span></a><span class="p">)</span>
<a href="../../_autosummary/LoopStructural.visualisation.LavaVuModelViewer.html#LoopStructural.visualisation.LavaVuModelViewer.rotate" title="LoopStructural.visualisation.LavaVuModelViewer.rotate" class="sphx-glr-backref-module-LoopStructural-visualisation sphx-glr-backref-type-py-method"><span class="n">viewer</span><span class="o">.</span><span class="n">rotate</span></a><span class="p">([</span><span class="o">-</span><span class="mf">85.18760681152344</span><span class="p">,</span> <span class="mf">42.93233871459961</span><span class="p">,</span> <span class="mf">0.8641873002052307</span><span class="p">])</span>
<a href="../../_autosummary/LoopStructural.visualisation.LavaVuModelViewer.html#LoopStructural.visualisation.LavaVuModelViewer.display" title="LoopStructural.visualisation.LavaVuModelViewer.display" class="sphx-glr-backref-module-LoopStructural-visualisation sphx-glr-backref-type-py-method"><span class="n">viewer</span><span class="o">.</span><span class="n">display</span></a><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_adding_folds_to_surfaces_002.png" srcset="../../_images/sphx_glr_plot_adding_folds_to_surfaces_002.png" alt="plot adding folds to surfaces" class = "sphx-glr-single-img"/></div>
<div class="section" id="plotting-the-fold-rotation-angles">
<h3>Plotting the fold rotation angles<a class="headerlink" href="#plotting-the-fold-rotation-angles" title="Permalink to this heading">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../_autosummary/LoopStructural.visualisation.RotationAnglePlotter.html#LoopStructural.visualisation.RotationAnglePlotter" title="LoopStructural.visualisation.RotationAnglePlotter" class="sphx-glr-backref-module-LoopStructural-visualisation sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rotation_plots</span></a> <span class="o">=</span> <a href="../../_autosummary/LoopStructural.visualisation.RotationAnglePlotter.html#LoopStructural.visualisation.RotationAnglePlotter" title="LoopStructural.visualisation.RotationAnglePlotter" class="sphx-glr-backref-module-LoopStructural-visualisation sphx-glr-backref-type-py-class"><span class="n">RotationAnglePlotter</span></a><span class="p">(</span><a href="../../_autosummary/LoopStructural.modelling.features.GeologicalFeature.html#LoopStructural.modelling.features.GeologicalFeature" title="LoopStructural.modelling.features.GeologicalFeature" class="sphx-glr-backref-module-LoopStructural-modelling-features sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">stratigraphy</span></a><span class="p">)</span>
<a href="../../_autosummary/LoopStructural.visualisation.RotationAnglePlotter.html#LoopStructural.visualisation.RotationAnglePlotter" title="LoopStructural.visualisation.RotationAnglePlotter" class="sphx-glr-backref-module-LoopStructural-visualisation sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rotation_plots</span></a><span class="o">.</span><span class="n">add_fold_limb_data</span><span class="p">()</span>
<span class="c1"># plt.plot(stratigraphy.builder.fold.fold_limb_rotation.fold_frame_coordinate,stratigraphy[&#39;limb_rotation&#39;],&#39;bo&#39;)</span>
<span class="c1"># x = np.linspace(fold_frame[0].min(),fold_frame[0].max(),100)</span>
<span class="c1"># plt.plot(x,stratigraphy[&#39;fold&#39;].fold_limb_rotation(x),&#39;r--&#39;)</span>
<a href="../../_autosummary/LoopStructural.visualisation.RotationAnglePlotter.html#LoopStructural.visualisation.RotationAnglePlotter" title="LoopStructural.visualisation.RotationAnglePlotter" class="sphx-glr-backref-module-LoopStructural-visualisation sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rotation_plots</span></a><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_adding_folds_to_surfaces_003.png" srcset="../../_images/sphx_glr_plot_adding_folds_to_surfaces_003.png" alt="plot adding folds to surfaces" class = "sphx-glr-single-img"/><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  15.337 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-2-fold-plot-adding-folds-to-surfaces-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/e053a703d3ff8854283431922f74588b/plot_adding_folds_to_surfaces.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_adding_folds_to_surfaces.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/9f98589f46bb70d492671d4a48f6bb07/plot_adding_folds_to_surfaces.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_adding_folds_to_surfaces.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>
</div>


            </article>
            
            
            
            <footer class="bd-footer-article">
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="index.html" title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">2. Modelling Folds</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="plot_refolded_folds.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">2b. Refolded folds</p>
  </div>
  <i class="fa-solid fa-angle-right"></i>
  </a>
</div>
            </footer>
            
          </div>
          
          
          
            <div class="bd-sidebar-secondary bd-toc">
              
<div class="toc-item">
  
<div class="tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
</div>
<nav id="bd-toc-nav" class="page-toc">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#imports">
   Imports
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#structural-geology-of-folds">
   Structural geology of folds
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modelling-folded-surfaces-without-structural-geology">
   Modelling folded surfaces without structural geology
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#modelling-folded-surfaces-using-loop-structural">
     Modelling folded surfaces using loop structural
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#testing-data-density">
     Testing data density
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#modelling-folds-using-structural-geology">
     Modelling folds using structural geology
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculating-the-fold-rotation-angles">
     Calculating the fold rotation angles
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plotting-the-fold-rotation-angles">
     Plotting the fold rotation angles
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
</div>

<div class="toc-item">
  
<div id="searchbox"></div>
</div>

<div class="toc-item">
  
</div>

<div class="toc-item">
  
<div class="tocsection sourcelink">
    <a href="../../_sources/_auto_examples/2_fold/plot_adding_folds_to_surfaces.rst.txt">
        <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
</div>

</div>

            </div>
          
          
        </div>
        <footer class="bd-footer-content">
          <div class="bd-footer-content__inner">
            
          </div>
        </footer>
        
      </main>
    </div>
  </div>

  
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94"></script>

 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>

  </body>
</html>