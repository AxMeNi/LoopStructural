
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>LoopStructural design &#8212; LoopStructural 1.5.13 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=862cd339"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'getting_started/loopstructural_design';</script>
    <script src="../_static/custom-icon.js?v=40bda21d"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Changelog" href="CHANGELOG.html" />
    <link rel="prev" title="Contribute" href="contributors_guide.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Mar 08, 2024"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/infinity_loop_icon.svg" class="logo__image only-light" alt=""/>
    <script>document.write(`<img src="../_static/infinity_loop_icon.svg" class="logo__image only-dark" alt=""/>`);</script>
  
  
    <p class="title logo__title">LoopStructural - 1.5.13</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../_auto_examples/index.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../user_guide/index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../API.html">
                        API
                      </a>
                    </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
                <li class="nav-item">
                  <a class="nav-link dropdown-item nav-external" href="https://www.loop3d.org">
                    Loop3d
                  </a>
                </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/loop3d" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/loop3d/LoopStructural" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/LoopStructural" title="PyPI" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-custom fa-pypi fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../_auto_examples/index.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../user_guide/index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../API.html">
                        API
                      </a>
                    </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links-2">
                    More
                </button>
                <ul id="pst-nav-more-links-2" class="dropdown-menu">
                    
                <li class="nav-item">
                  <a class="nav-link dropdown-item nav-external" href="https://www.loop3d.org">
                    Loop3d
                  </a>
                </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/loop3d" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/loop3d/LoopStructural" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/LoopStructural" title="PyPI" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-custom fa-pypi fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="background.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributors_guide.html">Contribute</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">LoopStructural design</a></li>
<li class="toctree-l1"><a class="reference internal" href="CHANGELOG.html">Changelog</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Getting Started</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">LoopStructur...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="loopstructural-design">
<h1>LoopStructural design<a class="headerlink" href="#loopstructural-design" title="Link to this heading">#</a></h1>
<p><strong>Authors:</strong> Lachlan Grose, Laurent Ailleres, Gautier Laurent, Mark Jessell, Roy Thomson</p>
<p><strong>Last updated:</strong> 1/11/2021</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>LoopStructural is a modular 3D geological modelling library with a flexible API for building 3D geological models. It provides access to implicit interpolators as well as geological feature/events.</p>
</section>
<section id="context">
<h2>Context<a class="headerlink" href="#context" title="Link to this heading">#</a></h2>
<p>The objective of geological modelling is to predict the geometry and distribution of geological objects in the subsurface. Different geological objects are represented by approximating an implicit function where isovalues/level sets of the implicit function define the geometry of geological features. The interaction between different geological objects is defined by the geological feature type (fault, fold, unconformity).</p>
</section>
<section id="goals-and-non-goals">
<h2>Goals and Non-Goals<a class="headerlink" href="#goals-and-non-goals" title="Link to this heading">#</a></h2>
<p>The aim of LoopStructural are:</p>
<ul class="simple">
<li><p>to provide an easy to use python API for building 3D geological models from data.</p></li>
<li><p>a platform for developing 3D modelling ideas, remove the requirement for boiler plate code.</p></li>
<li><p>integrate more geological observation types and knowledge into the modelling workflow</p></li>
</ul>
</section>
<section id="existing-solutions">
<h2>Existing Solutions<a class="headerlink" href="#existing-solutions" title="Link to this heading">#</a></h2>
<p>There are a number of commercial and open source 3D modelling packages available.</p>
<ul class="simple">
<li><p>Gocad/Skua provides a 3D modelling environment and an implicit interpolation algorithm</p></li>
<li><p>GemPy is a python based open source 3D modelling library that implements co-kriging and event management.</p></li>
<li><p>Geomodeller is a commerical package that implements the co-kriging algorithm and event management.</p></li>
<li><p>Petrel is a commercial package that implements implicit modelling.</p></li>
<li><p>Leapfrog is a commercial package that implements implicit modelling.</p></li>
<li><p>StructuralLab is a plugin for Gocad that implements discrete implicit modelling.</p></li>
</ul>
</section>
<section id="technical-architecture">
<h2>Technical Architecture<a class="headerlink" href="#technical-architecture" title="Link to this heading">#</a></h2>
<p><strong>Module design</strong> LoopStructural is divided into submodules which contain specific independent elements of the code.
The submodules separate clear differences in the functionality of the code.
The main modules for the library are:</p>
<ol class="arabic simple">
<li><p>interpolators</p></li>
<li><p>modelling</p></li>
<li><p>visualisation</p></li>
<li><p>utils</p></li>
<li><p>datasets</p></li>
</ol>
<p><strong>Coding paradigm</strong> LoopStructural is written in an object oriented paradigm.
The four pillars of object oriented coding should be adhered to:</p>
<ul class="simple">
<li><p><strong>Encapsulation</strong>: Attributes in python are designed to be accessible both within the class and from outside of the class. In LoopStructural, the where an attribute of a class should be private the <code class="docutils literal notranslate"><span class="pre">&#64;property</span></code> decorator should be used.</p></li>
<li><p><strong>Inheritance</strong>: Classes should inheret attributes and methods from parent classes.</p></li>
<li><p><strong>Polymorphism</strong>: Child classes, where a method is different from a parent class should override methods from parent classes.</p></li>
<li><p><strong>Abstraction</strong>: Classes should be designed to be abstract and avoid containing implementation details.</p></li>
</ul>
<p><strong>ABC</strong> LoopStructural uses abstract base classes to define the interface for different classes.</p>
<p><strong>Dependency management</strong> The library is written in python and is dependent on numpy, scipy. Care should be taken to avoid incorporating of uncessary dependencies. For dependencies that are not part of the standard scientific python toolkit (numfocus projects) the dependencies should be optional and not be required.</p>
<p><strong>Documentation</strong> The documentation is written for sphinx and should be formatted using the numpy style.</p>
<p><strong>Tests</strong> The tests are written using pytest and should be run using the command <code class="docutils literal notranslate"><span class="pre">pytest</span></code>.
There should be unit tests for all classes and methods.
Integration tests should be included to test the interaction between classes.</p>
<p><strong>Commits</strong> Commits should be made using the conventional commit style.</p>
<p><strong>CI/CD</strong> The code is automatically versioned using release-please.
When creating a commit use the conventional commit style e.g. <code class="docutils literal notranslate"><span class="pre">fix:</span> <span class="pre">bug</span> <span class="pre">fix</span></code>, <code class="docutils literal notranslate"><span class="pre">feat:</span> <span class="pre">new</span> <span class="pre">feature</span></code>, <code class="docutils literal notranslate"><span class="pre">chore:</span> <span class="pre">code</span> <span class="pre">change</span></code>.
A new patch pull request will be created when a bug fix is applied and passes the tests.
A new feature pull request will be created when a new feature is added and passes the tests.
When the new release is merged the library will be deployed to pypi, loop3d conda channel and dockerhub.
The documentation is automatically built when a new release is created and will be uploaded.
The entire CI/CD workflow is run using github actions.</p>
<section id="interpolators">
<h3>1. interpolators<a class="headerlink" href="#interpolators" title="Link to this heading">#</a></h3>
<p>The interpolation module contains different interpolators and associated supports used by LoopStructural.
The purpose of the interpolator is to build a 2D/3D scalar field from constraints (e.g. orientation, contact, fold).
The base of the interpolation module is the <strong>GeologicalInterpolator</strong> class.
The <strong>GeologicalInterpolator</strong> class contains the entry point for all interpolators and the functions for accessing constraints.
All implementations of interpolators are subclassed from the <strong>GeologicalInterpolator</strong>.
This module should include all interpolators and associated classes (e.g. mesh, grid, operators).
Future update: there should be a separate API so that the interpolators can be used without a GeologicalModel.</p>
</section>
<section id="modelling">
<h3>2. modelling<a class="headerlink" href="#modelling" title="Link to this heading">#</a></h3>
<p>The modelling is the main entry point to LoopStructural and includes the <strong>GeologicalModel</strong> class.
A <strong>GeologicalModel</strong> consists of <strong>GeologicalFeatures</strong> which define a particular geological phenomenon.
For example, a <strong>GeologicalFeature</strong> can be a stratigraphic sequence, a fault, a foliation, an unconformity, an intrusion.
The <strong>GeologicalFeature</strong> is something that can be evaluated within the model for a value, or gradient.</p>
<p>In LoopStructural the <strong>GeologicalFeature</strong> is built by a <strong>GeologicalFeatureBuilder</strong>.
The <strong>GeologicalFeatureBuilder</strong> is a class that manages the assembly of the interpolation constraints.
The builder is in charge of keeping track of whether the interpolator has been run and whether the data/constraints have changed.
The builder could also be used to build a <strong>GeologicalFeature</strong> without an interpolator.</p>
</section>
<section id="visualisation">
<h3>3. visualisation<a class="headerlink" href="#visualisation" title="Link to this heading">#</a></h3>
<p>The visualisation module is in charge of creating 2D/3D visualisations for the GeolgicalModel and GeologicalFeatures.</p>
<section id="d-visualisation">
<h4>3D visualisation<a class="headerlink" href="#d-visualisation" title="Link to this heading">#</a></h4>
<p>The 3D visualisation module for LoopStructural has been written using an abstract base class.
<strong>BaseModelPlotter</strong> contains all of the methods for plotting the various different attributes for a GeologicalModel.
A visualisation module can be implemented by simply subclassing the <strong>BaseModelPlotter</strong> and implementing the following methods:</p>
<ul class="simple">
<li><p><cite>_add_surface(self,vertices,face,name)</cite> to add a triangular surface to the plot.</p></li>
<li><p><cite>_add_points(self,points,name,value=None)</cite> to add xyz points with an optional value attribute to colour by.</p></li>
<li><p><cite>_add_vector_marker(self, location, vector, name symbol_type=arrow)</cite> to add a vector marker to the plot.</p></li>
</ul>
</section>
</section>
<section id="utils">
<h3>4. utils<a class="headerlink" href="#utils" title="Link to this heading">#</a></h3>
<p>The utils module is a container for utility functions that are used throughout the library.
Where possible util functions should be stored in separate files that are imported in the <cite>__init__.py</cite> file.</p>
</section>
</section>
<section id="testing">
<h2>Testing<a class="headerlink" href="#testing" title="Link to this heading">#</a></h2>
<p>LoopStructural uses a combination of unit tests, integration tests and end to end tests.
Any new modules/functions should be accompanied by a unit test.
A unit test is the small independent test that ensures the basic functionality of the block of code is working.
A good unit test suite for a block of code will test different possible scenarios to ensure that the correct behaviour
is observed when the appropriate parameters are provided and when incorrect parameters are provided.</p>
<p>LoopStructual uses the testing framework <cite>pytest</cite> for running the testing.
Unit tests should be placed in the <cite>testsunit</cite> directory and files containing tests should be prepended with the prefix <cite>test_</cite>.
Test datasets can be generated using pytest fixtures.
A fixture is a function that can be called by a test for a range of predefined parameters.
For example a fixture to generate different discrete interpolators would be</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">LoopStructural.interpolators</span> <span class="kn">import</span> <span class="n">FiniteDifferenceInterpolator</span> <span class="k">as</span> <span class="n">FDI</span><span class="p">,</span> \
                                        <span class="n">PiecewiseLinearInterpolator</span> <span class="k">as</span> <span class="n">PLI</span>
<span class="kn">from</span> <span class="nn">LoopStructural.interpolators</span> <span class="kn">import</span> <span class="n">StructuredGrid</span><span class="p">,</span> <span class="n">TetMesh</span>

<span class="kn">import</span> <span class="nn">pytest</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;FDI&#39;</span><span class="p">,</span><span class="s1">&#39;PLI&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">interpolator</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">interpolator</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">param</span>
    <span class="n">origin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1</span><span class="p">])</span>
    <span class="n">maximum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">1.1</span><span class="p">])</span>
    <span class="n">nsteps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">])</span>
    <span class="n">step_vector</span> <span class="o">=</span> <span class="p">(</span><span class="n">maximum</span><span class="o">-</span><span class="n">origin</span><span class="p">)</span><span class="o">/</span><span class="n">nsteps</span>
    <span class="k">if</span> <span class="n">interpolator</span> <span class="o">==</span> <span class="s1">&#39;FDI&#39;</span><span class="p">:</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="n">StructuredGrid</span><span class="p">(</span><span class="n">origin</span><span class="o">=</span><span class="n">origin</span><span class="p">,</span><span class="n">nsteps</span><span class="o">=</span><span class="n">nsteps</span><span class="p">,</span><span class="n">step_vector</span><span class="o">=</span><span class="n">step_vector</span><span class="p">)</span>
        <span class="n">interpolator</span> <span class="o">=</span> <span class="n">FDI</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">interpolator</span>
    <span class="k">elif</span> <span class="n">interpolator</span> <span class="o">==</span> <span class="s1">&#39;PLI&#39;</span><span class="p">:</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="n">TetMesh</span><span class="p">(</span><span class="n">origin</span><span class="o">=</span><span class="n">origin</span><span class="p">,</span><span class="n">nsteps</span><span class="o">=</span><span class="n">nsteps</span><span class="p">,</span><span class="n">step_vector</span><span class="o">=</span><span class="n">step_vector</span><span class="p">)</span>
        <span class="n">interpolator</span> <span class="o">=</span> <span class="n">PLI</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">interpolator</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Invalid interpolator: </span><span class="si">{</span><span class="n">interpolator</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This fixture can then be called by any test in the testing suite:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">LoopStructural.interpolators</span> <span class="kn">import</span> <span class="n">GeologicalInterpolator</span>

<span class="k">def</span> <span class="nf">test_interpolator</span><span class="p">(</span><span class="n">interpolator</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test whether the discrete interpolators are a subclass of GeologicalInterpolator</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">interpolator</span><span class="p">,</span> <span class="n">GeologicalInterpolator</span><span class="p">)</span>
</pre></div>
</div>
<p>Unit tests should be as small as possible and require minimal computation to test whether they are working.
Ideally the unit test will only be testing a very small portion of code.
An integration test may be a more substantial test, which will test whether multiple sections of code act as they
are intended.
An end to end test will be a complete geological modelling workflow and will require significant computational time.
End to end tests should be used sparingly as identifying the true cause of a failed test may be challenging.</p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="contributors_guide.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Contribute</p>
      </div>
    </a>
    <a class="right-next"
       href="CHANGELOG.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Changelog</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#context">Context</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#goals-and-non-goals">Goals and Non-Goals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#existing-solutions">Existing Solutions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#technical-architecture">Technical Architecture</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpolators">1. interpolators</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelling">2. modelling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualisation">3. visualisation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#d-visualisation">3D visualisation</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#utils">4. utils</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#testing">Testing</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../_sources/getting_started/loopstructural_design.rst">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>

  </body>
</html>